!function(e,a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(function(){return a()}):e.datepicker=a()}(this,function(){"use strict";Array.prototype.includes||(Array.prototype.includes=function(e){let a=!1;return this.forEach(t=>{t===e&&(a=!0)}),a});let e=[];const a=["click","focusin","keydown","input"],t=["ПН","ВТ","СР","ЧТ","ПТ","СБ","ВС"],n=["ЯНВАРЬ","ФЕВРАЛЬ","МАРТ","АПРЕЛЬ","МАЙ","ИЮНЬ","ИЮЛЬ","АВГУСТ","СЕНТЯБРЬ","ОКТЯБРЬ","НОЯБРЬ","ДЕКАБРЬ"],r=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"];function c(e){if(e.ifRangeActive){d(e);const a=e.calendar.querySelector(".calendar__datepicker-active");if(a){a.classList.add("calendar__datepicker-active-range");const t=Array.from(e.calendar.querySelectorAll(".calendar__datepicker-square.calendar__datepicker-num")),n=t.indexOf(a);let r,c;for(let e=1;e<=3;e++)3!==e?(n+e<t.length&&(t[n+e].classList.contains("calendar__datepicker-disabled")||t[n+e].classList.contains("calendar__datepicker-empty")?c||(c=!0,t[n+e-1].classList.remove("calendar__datepicker-num-range"),t[n+e-1].classList.add("calendar__datepicker-num-range-right")):t[n+e].classList.add("calendar__datepicker-num-range")),n-e>-1&&(t[n-e].classList.contains("calendar__datepicker-disabled")||t[n-e].classList.contains("calendar__datepicker-empty")?r||(r=!0,t[n-e+1].classList.remove("calendar__datepicker-num-range"),t[n-e+1].classList.add("calendar__datepicker-num-range-left")):t[n-e].classList.add("calendar__datepicker-num-range"))):(n+e<t.length&&(t[n+e].classList.contains("calendar__datepicker-disabled")||t[n+e].classList.contains("calendar__datepicker-empty")?c||(t[n+e-1].classList.remove("calendar__datepicker-num-range"),t[n+e-1].classList.add("calendar__datepicker-num-range-right")):t[n+e].classList.add("calendar__datepicker-num-range-right")),n-e>-1&&(t[n-e].classList.contains("calendar__datepicker-disabled")||t[n-e].classList.contains("calendar__datepicker-empty")?r||(t[n-e+1].classList.remove("calendar__datepicker-num-range"),t[n-e+1].classList.add("calendar__datepicker-num-range-left")):t[n-e].classList.add("calendar__datepicker-num-range-left")))}}}function d(e){const a=e.calendar.querySelector(".calendar__datepicker-active-range");if(a){a.classList.remove("calendar__datepicker-active-range");const t=Array.from(e.calendar.querySelectorAll(".calendar__datepicker-square.calendar__datepicker-num")),n=t.indexOf(a);for(let e=0;e<=3;e++)n+e<t.length&&(t[n+e].classList.remove("calendar__datepicker-num-range"),t[n+e].classList.remove("calendar__datepicker-num-range-right")),n-e>-1&&(t[n-e].classList.remove("calendar__datepicker-num-range-left"),t[n-e].classList.remove("calendar__datepicker-num-range"))}}function i(e,a){const t=function(e,a){return`\n      <div class="calendar__datepicker-controls">\n        <div class="calendar__datepicker-arrow calendar__datepicker-left"></div>\n        <div class="calendar__datepicker-month-year">\n          <span class="calendar__datepicker-month">${a.months[e.getMonth()]}</span>\n          <span class="calendar__datepicker-year">${e.getFullYear()}</span>\n        </div>\n        <div class="calendar__datepicker-arrow calendar__datepicker-right"></div>\n      </div>\n    `}(e,a),n=function(e,a){const{minDate:t,dateSelected:n,currentYear:r,currentMonth:c,days:d}=a,i=new Date,s=i.toDateString()===e.toDateString(),l=new Date(new Date(e).setDate(1)),o=l.getDay()-a.startDay,_=o<0?7:0;l.setMonth(l.getMonth()+1),l.setDate(0);const u=l.getDate(),p=[];let h=_+7*((o+u)/7|0);h+=(o+u)%7?7:0,0!==a.startDay&&0===o&&(h+=7);for(let e=1;e<=h;e++){const a=d[(e-1)%7],l=e-(o>=0?o:7+o),_=new Date(r,c,l);let u=`<span class="calendar__datepicker-num">${_.getDate()}</span>`,h=t&&_<t;d[6],d[0];const g=s&&!h&&l===i.getDate();let k="";k=h?"calendar__datepicker-disabled":g?"calendar__datepicker-current":"",_.toDateString()===n.toDateString()&&(k+=" calendar__datepicker-active"),_.getFullYear()<r||_.getFullYear()===r&&_.getMonth()<c?k+=" prev-month":(_.getFullYear()>r||_.getFullYear()===r&&_.getMonth()>c)&&(k+=" next-month"),p.push(`<div class="calendar__datepicker-square calendar__datepicker-num ${a} ${k}">${u}</div>`)}const g=d.map(e=>`<div class="calendar__datepicker-square calendar__datepicker-day">${e}</div>`).concat(p);return g.unshift('<div class="calendar__datepicker-squares">'),g.push("</div>"),g.join("")}(e,a);let r="";a.ifRange&&(r='\n\t\t\t<label class="calendar__datepicker-checkbox">\n\t\t\t\t<input type="checkbox" checked class="calendar__datepicker-checkbox__input" id="id-calendar__datepicker-checkbox">\n\t\t\t\t<span class="calendar__datepicker-checkbox__custom"></span>\n\t\t\t\t<span class="calendar__datepicker-checkbox__label">± 3 дня</span>\n\t\t\t</label>\n    '),a.calendar.innerHTML=t+n+r}function s(e){if(e.formatter)return e.formatter(e.input,e.dateSelected);const a=e.dateSelected.getFullYear(),t=e.dateSelected.getMonth()+1,n=t<10?0:"",r=e.dateSelected.getDate(),c=r<10?0:"";e.input.value=`${a}-${n}${t}-${c}${r}`}function l(e,a){e=function(e){return new Date(e.toDateString())}(e),this.currentYear=e.getFullYear(),this.currentMonth=e.getMonth(),this.currentMonthName=this.months[e.getMonth()],this.dateSelected=a?void 0:e,!a&&s(this),i(e,this),a&&(this.input.value="")}function o(){this.setDate(this.startDate,!0)}function _(){const{calendar:t,parent:n,el:r}=this;a.forEach(e=>{window.removeEventListener(e,p)}),t.remove(),e=e.filter(e=>e!==r)}function u(e){e.calendar.classList.remove("calendar__datepicker-hidden"),e.calendar.parentNode.classList.add("open"),function(e){const{el:a,calendar:t}=e,n=`\n      top:${a.getBoundingClientRect().height}px;\n      left: 0px;\n    `;t.setAttribute("style",n)}(e),e.onShow&&e.onShow(e)}function p(e){if(this.isMobile&&this.disableMobile)return;if(!e.path){let a=e.target,t=[];for(;a!==document;)t.push(a),a=a.parentNode;e.path=t}const{type:a,path:t,target:n}=e,{calendar:l,el:o}=this,_=l.classList.contains("calendar__datepicker-hidden"),p=t.includes(l);if("focusin"===a)return n===o&&u(this);var h;_?n===o&&u(this):"click"===a&&p?function(e){const{calendar:a}=e,t=n.classList;a.querySelector(".calendar__datepicker-month-year"),t.contains("calendar__datepicker-close");if(t.contains("calendar__datepicker-num")){const a="SPAN"===n.nodeName?n.parentNode:n,t=["calendar__datepicker-disabled","calendar__datepicker-active","calendar__datepicker-empty"].some(e=>a.classList.contains(e));!t&&function(e,a){const{currentMonth:t,currentYear:n,calendar:d,el:i,onSelect:l}=a,o=d.querySelector(".calendar__datepicker-active"),_=e.textContent;let u=new Date(n,t,_);e.classList.contains("prev-month")?u.setMonth(u.getMonth()-1):e.classList.contains("next-month")&&u.setMonth(u.getMonth()+1),a.dateSelected=u,a.calendar.parentNode.querySelector(".calendar__selected-date").innerHTML=`${_} ${r[u.getMonth()]} ${u.getFullYear()}`,o&&o.classList.remove("calendar__datepicker-active"),e.classList.add("calendar__datepicker-active"),a.ifRange&&a.ifRangeActive&&c(a),s(a),l&&l(a)}(a,e)}else t.contains("calendar__datepicker-arrow")&&function(e,a,t){if(t?a.currentYear=t:(a.currentMonth+=e.contains("calendar__datepicker-right")?1:-1,12===a.currentMonth?(a.currentMonth=0,a.currentYear++):-1===a.currentMonth&&(a.currentMonth=11,a.currentYear--)),i(new Date(a.currentYear,a.currentMonth,1),a),a.currentMonthName=a.months[a.currentMonth],a.onMonthChange&&t&&a.onMonthChange(a),a.ifRange){d(a),c(a);const e=a.calendar.querySelector(".calendar__datepicker-checkbox__input");e.addEventListener("click",()=>{a.ifRangeActive=!a.ifRangeActive,a.ifRangeActive?(c(a),a.calendar.parentNode.querySelector(".calendar__three-days").classList.remove("calendar__three-days_hidden")):(d(a),a.calendar.parentNode.querySelector(".calendar__three-days").classList.add("calendar__three-days_hidden"))}),a.ifRangeActive||(e.checked=!1)}}(t,e)}(this):((h=this).calendar.classList.add("calendar__datepicker-hidden"),h.calendar.parentNode.classList.remove("open"),h.onHide&&h.onHide(h))}return function(u,h){if(!u||"object"!=typeof u)return void console.error(`datepicker: el error, el equal ${u}, el is ${typeof u}`);h&&(h=function(a,t){if(e.includes(t))throw new Error("A datepicker already exists on that element.");let{minDate:n,dateSelected:r,formatter:c}=a;return["onSelect","onShow","onHide","onMonthChange"].forEach(e=>{a[e]="function"==typeof a[e]&&a[e]}),a}(h||null,u));const g=document.createElement("div"),k=new Date;let f=new Date;f.setDate(k.getDate()-1);const m={el:u,input:null,dateSelected:k,ifRange:!!h&&h.ifRange,ifRangeActive:null,minDate:f,calendar:g,currentMonth:k.getMonth(),currentMonthName:n[k.getMonth()],currentYear:k.getFullYear(),setDate:l,reset:o,remove:_,onSelect:h?h.onSelect:void 0,onShow:h?h.onShow:void 0,onHide:h?h.onHide:void 0,onMonthChange:h?h.onMonthChange:void 0,formatter:h?h.formatter:void 0,months:n,days:t,startDay:1,disableMobile:!1,isMobile:"ontouchstart"in window};if(g.classList.add("calendar__datepicker"),g.classList.add("calendar__datepicker-hidden"),e.push(u),i(k,m),a.forEach(e=>{window.addEventListener(e,p.bind(m))}),u.appendChild(g),g.parentNode.querySelector(".calendar__selected-date").innerHTML=`${k.getDate()} ${r[k.getMonth()]} ${k.getFullYear()}`,g.parentNode.querySelector(".calendar__three-days").innerHTML="± 3 дня",m.ifRange){const e=g.querySelector(".calendar__datepicker-checkbox__input");e.addEventListener("click",()=>{m.ifRangeActive=!m.ifRangeActive,m.ifRangeActive?(c(m),m.calendar.parentNode.querySelector(".calendar__three-days").classList.remove("calendar__three-days_hidden")):(d(m),m.calendar.parentNode.querySelector(".calendar__three-days").classList.add("calendar__three-days_hidden"))}),m.ifRangeActive=e.checked,m.ifRangeActive&&c(m)}else m.calendar.parentNode.removeChild(m.calendar.parentNode.querySelector(".calendar__three-days"));return m.input=g.parentNode.querySelector(".calendar__input"),k&&s(m),m}});